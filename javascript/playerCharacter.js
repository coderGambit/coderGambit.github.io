var spriteChangeSpeed=50,spriteChangeSpeedInterval=6,DEFAULT_PLAYER_SPEED=4,RUN_SPEED=6,jumpHeightLimit=150,animator=new Animator,debugCounter=0,debugFPS=60;function PlayerSprite(t,i){this.scaleX=t,this.scaleY=i,this.spriteSpeedChangeTime=Math.round(6)}PlayerSprite.prototype.createSprite=function(t,i,e,s,h,n){return this.img=t||new Image,this.img.src||(i?(this.img.src=i,this.path=i):console.log("The image has no source, and there was no path specified")),this.destination=void 0,this.startValue=void 0,this.distance=void 0,this.currentIteration=0,this.totalIteration=30,this.landY=void 0,this.singleSpriteWidth=e,this.singleSpriteHeight=s,this.entireSpriteWidth=h,this.entireSpriteHeight=n,this.coloumnCount=Math.floor(this.entireSpriteWidth/this.singleSpriteWidth),this.rowCount=Math.floor(this.entireSpriteHeight/this.singleSpriteHeight),this.currentColumn,this.currentRow,this.spriteSpeedCurrentTime=0,this.drawnWidth=this.singleSpriteWidth/this.scaleX,this.drawnHeight=this.singleSpriteHeight/this.scaleY,this.goingLeft=!1,this.goingRight=!1,this.jump=!1,this.falling=!0,this.jumping=!1,this.isLoaded=!1,this.left,this.right,this.top,this.bottom,this},PlayerSprite.prototype.resetPlayer=function(){this.destination=void 0,this.startValue=void 0,this.distance=void 0,this.currentIteration=0,this.spriteSpeedCurrentTime=0,this.goingLeft=!1,this.goingRight=!1,this.jump=!1,this.falling=!0,this.jumping=!1},PlayerSprite.prototype.calculateBoundingBox=function(){this.left=this.x,this.right=this.left+this.drawnWidth,this.top=this.y,this.bottom=this.top+this.drawnHeight},PlayerSprite.prototype.initialState=function(t,i,e){this.x=t,this.y=i,this.calculateBoundingBox(),this.drawSprite(0,0,t,i,e),this.currentColumn=0,this.currentRow=0,!this.isLoaded&&(this.isLoaded=!0)},PlayerSprite.prototype.drawSprite=function(t,i,e,s,h){this.clearSprite(h),h.drawImage(this.img,t*this.singleSpriteWidth,i*this.singleSpriteHeight,this.singleSpriteWidth,this.singleSpriteHeight,e,s,this.drawnWidth,this.drawnHeight)},PlayerSprite.prototype.clearSprite=function(t){t.clearRect(0,0,800,800)},PlayerSprite.prototype.move=function(t){this.checkKeys(),this.goingLeft&&!this.goingRight?(this.goLeft(),this.toggleSpriteImage(t)):this.goingRight&&!this.goingLeft&&(this.goRight(),this.toggleSpriteImage(t));var i=onLand(this.x,this.y);this.isJumping(i)?(this.organizeValues(),this.jumpUp(),playJumpSound()):this.isFalling(i)?(this.organizeValues(i),this.fallDown()):(!this.goingLeft||!this.goingRight||this.goingLeft&&this.goingRight)&&(this.moveWithLand(),this.toggleSpriteImage(t))},PlayerSprite.prototype.organizeValues=function(t){this.checkDestination(t),this.checkStartValue(),this.checkDistance()},PlayerSprite.prototype.checkDestination=function(t){this.jumping&&t?this.destination=Math.abs(this.y-(this.distance=this.run?240:200)):this.falling&&(this.destination=801)},PlayerSprite.prototype.setFallingStop=function(){return!isNaN(this.landY)&&null!==this.landY&&this.y>=this.landY&&(this.y=this.landY,this.calculateBoundingBox(),!0)},PlayerSprite.prototype.checkStartValue=function(){(void 0===this.startValue||0===this.startValue)&&(this.startValue=this.y)},PlayerSprite.prototype.checkDistance=function(){this.falling?(void 0===this.distance||0===this.distance)&&(this.distance=Math.abs(this.destination-this.y)):this.jumping?(void 0===this.distance||0===this.distance)&&(this.distance=this.run?240:200):this.distance=void 0},PlayerSprite.prototype.jumpUp=function(){this.y=animator.cubicEaseOut(this.currentIteration++,this.startValue,-this.distance,this.totalIteration),this.calculateBoundingBox(),(this.currentIteration>this.totalIteration||this.playerOverJumpLimit())&&this.endJumpUp()},PlayerSprite.prototype.playerOverJumpLimit=function(){return this.top<=jumpHeightLimit&&(this.y=jumpHeightLimit,this.calculateBoundingBox(),!0)},PlayerSprite.prototype.endJumpUp=function(){this.currentIteration=0,this.jumping=!1,this.falling=!0,this.destination=0,this.startValue=0,this.distance=0},PlayerSprite.prototype.fallDown=function(){this.landY=getLandY(this.x,this.y),this.y=animator.cubicEaseIn(this.currentIteration++,this.startValue,this.distance,this.totalIteration),this.calculateBoundingBox(),this.top>800&&gameOver(!1),(this.setFallingStop()||this.currentIteration>this.totalIteration)&&this.endFallDown()},PlayerSprite.prototype.endFallDown=function(){this.currentIteration=0,this.falling=!1,this.destination=0,this.startValue=0,this.distance=0},PlayerSprite.prototype.moveWithLand=function(){this.isGoneOffLeft()||(this.x-=getLandSpeed(),this.calculateBoundingBox())},PlayerSprite.prototype.isGoneOffLeft=function(){return this.left<=0},PlayerSprite.prototype.isGoneOffRight=function(){return this.right>=800},PlayerSprite.prototype.goLeft=function(){this.isGoneOffLeft()?this.x=0:this.x-=this.run?RUN_SPEED:DEFAULT_PLAYER_SPEED,this.calculateBoundingBox()},PlayerSprite.prototype.goRight=function(){this.isGoneOffRight()?this.x=800-this.drawnWidth:this.x+=this.run?RUN_SPEED:DEFAULT_PLAYER_SPEED,this.calculateBoundingBox()},PlayerSprite.prototype.isJumping=function(t){return void 0!==t?this.jumping?this.jumping:this.jumping=this.jump&&t:this.jumping?this.jumping:this.jumping=this.jump&&onLand(this.x,this.y)},PlayerSprite.prototype.isFalling=function(t){return void 0!==t?this.jumping||t?this.falling=!1:this.falling=this.y<800:this.jumping||onLand(this.x,this.y)?this.falling=!1:this.falling=this.y<800},PlayerSprite.prototype.checkKeys=function(){KEY.isDown(KEY.LEFT)||KEY.isDown(KEY.LEFT_Z_BUTTON)?this.goingLeft=!0:this.goingLeft=!1,KEY.isDown(KEY.RIGHT)||KEY.isDown(KEY.RIGHT_X_BUTTON)?this.goingRight=!0:this.goingRight=!1,KEY.isDown(KEY.JUMP)||KEY.isDown(KEY.JUMP_UP)?this.jump=!0:this.jump=!1,KEY.isDown(KEY.RUN)?this.run=!0:this.run=!1},PlayerSprite.prototype.toggleSpriteImage=function(t){this.spriteSpeedCurrentTime++>=this.spriteSpeedChangeTime/(this.run?2:1)&&(this.switchImage(),this.spriteSpeedCurrentTime=0)},PlayerSprite.prototype.switchImage=function(){this.goingLeft&&this.leftSwitch(),this.goingRight&&this.rightSwitch(),(this.goingLeft&&this.goingRight||!this.goingLeft&&!this.goingRight)&&(this.currentRow=0)},PlayerSprite.prototype.leftSwitch=function(){switch(this.currentRow){case 3:this.currentRow=4;break;case 4:this.currentRow=3;break;default:this.currentRow=3}},PlayerSprite.prototype.rightSwitch=function(){switch(this.currentRow){case 1:this.currentRow=2;break;case 2:this.currentRow=1;break;default:this.currentRow=1}},PlayerSprite.prototype.jumpSwicth=function(){this.currentRow,this.currentRow=5};
//# sourceMappingURL=playerCharacter.js.map
